version: 2.1

jobs:
  hello-job:
    machine:
      image: ubuntu-2004:202008-01
    steps:
      - checkout # Check out the code in the project directory
      - run:
          name: Install nvm and Node.js
          command: |
            curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.2/install.sh | bash
            export NVM_DIR="$HOME/.nvm"
            [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
            nvm install node
            nvm use node
      - run:
          name: Install npm@latest and snyk
          command: |
            export NVM_DIR="$HOME/.nvm"
            [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
            npm install -g npm@latest
            npm install -g snyk
      - run:
          name: Check npm and snyk versions
          command: |
            export NVM_DIR="$HOME/.nvm"
            [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
            npm --version
            snyk --version
      - run: echo "hello world" # Run the `echo` command

workflows:
  my-workflow:
    jobs:
      - hello-job
